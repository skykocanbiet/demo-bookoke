<style type="text/css">
.multiselect-container>li.active
	{
		border-bottom: 0px !important;
	}


.checkbox{
	font-size: 14px;
	padding: 0px;
	padding-top: -2px;
}
 #mn_nav .dropdown-menu>li>a:focus, #mn_nav .dropdown-menu>li>a:hover
	 {
	 	 background-color: #dddddd !important;
	 	
	 }
#mn_nav .dropdown-menu
	{
		right: auto;
		color: black;
		overflow:auto;
		height: 200px;
		width: 500px;
	}
#mn_nav .dropdown-user
	{
		right: 0px;
		color: black;
		overflow:auto;
		height: auto;
		
	}
#mn_nav .dropdown-alerts

	{
		right: 0px;
		color: black;
		overflow:auto;
		height: auto;
		
	}

#i 
	{
		position: absolute;
		background: rgb(255, 255, 255);
		opacity: 2;
		cursor: pointer;
		border: 1px solid #CCC;
		border-top-color: rgb(204, 204, 204);
		border-top-style: solid;
		border-top-width: 1px;
		border-right-color: rgb(204, 204, 204);
		border-right-style: solid;
		border-right-width: 1px;
		border-bottom-color: rgb(204, 204, 204);
		border-bottom-style: solid;
		border-bottom-width: 1px;
		border-left-color: rgb(204, 204, 204);
		border-left-style: solid;
		border-left-width: 1px;
		border-image-source: initial;
		border-image-slice: initial;
		border-image-width: initial;
		border-image-outset: initial;
		border-image-repeat: initial;
		width: 58px;
		border-radius: 35px;
		height: 58px;
		text-align-last: center;
		background-color: #fff;
		font-weight: bold;
		font-size: 40px;
		text-align: center;
		width: 60px;
		height: 60px;
		font-size: 2em;
		top: 14%;
		left: 40%;
	}
	
	.imgUser 
		{
			height: 100px;
			position: absolute;
			width: 100px;
			z-index: 10;
			height: 60px;
			line-height: 61px;
		}
	
	.services 
		{
			margin-left: 7%;
			color: black;
			right: 0px;
			left: 0px;
		}
	.input-form
		{
			border-radius: 4px;
			background: #F1F5F7 !important;
			border: 0;
			margin-left: auto;
			width: 70%;
			height: 30px;
			margin-left: 4px;
			padding: 6px;
		}
	.input-form:focus
		{
			box-shadow: 1px 1px 5px 0px #33CCCC;
			border-radius: 5px;
			border: 1px solid #33CCCC;
		}
		.input-form:hover
		{
			background: #F1F5F7;
		}
	/*.col-sm-8 input:FOCUS[type="text"] 
		{
			box-shadow: 1px 1px 1px 1px #33CCCC;
			border-radius: 5px;
			border: 1px solid #33CCCC;
		}*/

	/*.col-sm-8  input:hover[type="text"] 
		{
			background: #F1F5F7;
		}*/

.row:hover {
	
}

	.pager 
		{
			float: left;
		}

	.ul-list .badge 
		{
			background-color: #00FFFF;
		}

	.ul-list1 .badge 
		{
			background: #EEE;
		}

	.col-sm-2 label 
		{
			float: right;
			right: 30%;
			color: #999;
			cursor: default;
			
		}

	.ul-list li 
		{
			line-height: 40px;
			cursor: pointer;
			display: inline-block;
			width: 150px;
		}

	.row-active 
		{
			margin-left: -30px;
		}

.active {
	
		}

	

	
	.stacked-list 
		{
			list-style: none;
			list-style: none;
			list-style-type: none;
			list-style-position: initial;
			list-style-image: initial;
			margin-left: 0px;
			
		}

	.row-active .active li 
		{
			display: list-item;
			text-align: -webkit-match-parent;
			border: none;
		}

	.checkboxwrapper 
		{
			display: inline-block;
			width: 3.982906% !important;
		}



	.chexboxUnChecked 
		{
			background: url(../../images/checkBoxBg.png) no-repeat 0px -32px !important;
			vertical-align: middle;
			height: 20px;
			width: 20px;
			display: inline-block;
		}


	.camera 
		{
			position: absolute;
			background: rgb(255, 255, 255);
			text-align: center;
			opacity: 0.8;
			display: none;
			cursor: pointer;
			border: 1px solid #CCC;
		}

	.img-circle 
		{
			border-radius: 500px;
		}

	.hide 
		{
			display: none;
		}

	.image 
		{
			margin-left: 29px;
		}
	.checkbox1
		{
			padding: 5px 5px 5px 5px;
			
		}
	.checkbox1:HOVER 
		{
			background-color: #dff6f5;
			font-weight: bold;
		}
span.multiselect-native-select 
	{
	    position: relative;
	}
	.caret 
		{
		    display: inline-block;
		    width: 0;
		    height: 0;
		    margin-left: 2px;
		    vertical-align: middle;
		    border-top: 4px solid;
		    border-right: 4px solid transparent;
		    border-left: 4px solid transparent;
		}
	.checkbox, .radio 
		{
			color: black;
			padding-top: 2px;
		}
	.multiselect-container>li>a>label
		{
			  padding: 0px 0px 0px 20px;
			  padding-right: auto;
		}
	.dropdown-menu>.active>a, .dropdown-menu>.active>a:focus, .dropdown-menu>.active>a:hover 
		{
			 background-color: #ccc;
			
		
		}
/*#tabcontent ul li a {
   
    padding: 9px;
}
#tabcontent .nav li a{
	border: none;
	margin:0px;
	color: #C1C8CD;
	font-size: 14px;
	text-transform: uppercase;
	padding: 12px;
}*/
#rowHS {
	margin-bottom: 5px;
}
#rowHS .lable
{
	padding: 5px;
}
.off .slider_off,.off .slider_switch{
	left: 1px;
}
.off .slider_on{
	left: -57px;
}
</style>
<script type="text/javascript">

$(function() {
	
		$(".imgUser").css("opacity","0");
		$(".imgUser").hover(function () 
			{
				$(this).stop().animate({opacity: .7}, "slow");
			},
		function () {
		$(this).stop().animate({
		opacity: 0
		}, "slow");
	});
	});
	//  $("#checkAll").change(function () {
 // 	    $("input:checkbox").prop('checked', $(this).prop("checked"));
 // 	  	$(".checkbox1").toggleClass('first');
	// });
 	
    $(document).ready(function() {
        // $('#example-enableCollapsibleOptGroups-enableClickableOptGroups-enableFiltering-includeSelectAllOption').multiselect({
        //     enableClickableOptGroups: true,
        //     enableCollapsibleOptGroups: true,
        //     enableFiltering: true,
        //     includeSelectAllOption: true
        // });
    });

 	
/* js */

	   $(document).ready(function() {
         $('#example-enableClickableOptGroups-disabled').multiselect({
         			enableCaseInsensitiveFiltering: true,
                    includeSelectAllOption: true,
                    });
         });

</script>  
<!--    <?php
	//if(isset($_POST['$id'])&& ($_POST['$model']) &&($_POST['$data']))
?> -->

<div id="content_tab_information" style="overflow: auto;" class="col-sm-12">
	<form method="post" role="form" id="form_data_user" name="form_data_user" enctype="multipart/form-data" class="row" style="margin-top: 20px;width: 100%">
		<input type="hidden" id="id_dentist" name="id_dentist" value="<?php echo $model->id; ?>"></input>
		<div id="alert-success" style="position: fixed;top: 50px;right: 0px;">
			<!-- <div class = "alert alert-success" id="success-alert">
			   <a href = "#" class = "close" data-dismiss = "alert">&times;</a>
			   <strong>Thành Công!</strong> Đã cập nhật...
			</div>
			<div class = "alert alert-success" id="success-alert">
			   <a href = "#" class = "close" data-dismiss = "alert">&times;</a>
			   <strong>Thành Công!</strong> Đã cập nhật...
			</div> -->
		</div>
		<!-- <div class = "alert alert-success" id="success-alert" style="display:none;position: fixed;top: 50px;right: 0px;" >
		   <a href = "#" class = "close" data-dismiss = "alert">&times;</a>
		</div> -->
		<div class="col-sm-12">
			<div id='img' class="col-sm-2">
				<div style="position: relative; width: 80px; height: 80px;">
					<span class="imgUser " style="float: right;"> 
						<i id="i">
							<span class=" glyphicon glyphicon-camera icon-2x" style="position: absolute; top: 30%; left: 29%;"></span> 
							<input type="file" id="staffimageinput" name="staffimageinput" style="border-radius: 100%; position: absolute; width: 80px; height: 80px; left: -1px; top: -9px; opacity: 0">
						</i>
					</span>
					<?php if ($model->image ==null){ ?>
					<img id="hinh_user" class="image" src="<?php echo Yii::app()->request->baseUrl;?>/upload/users/no_avatar.png" style="width: 100%; height: 100%; border-radius: 100%;">
					<?php }else{ ?>
					<img id="hinh_user" class="image" src="<?php echo Yii::app()->request->baseUrl;?>/upload/users/md/<?php echo $model->image ?>" style="width: 100%; height: 100%; border-radius: 100%;">
					<?php }?>	
				</div>
			</div>

			<div class="col-sm-8">
				<input class="input-form" type="text" style=" margin-bottom: 3px; font-weight: bold; font-size: 20px; height: 50px;text-transform: uppercase; " id="name_user" name="name_user" value="<?php echo $model->name; ?>" />
			</div>
			<div class="col-sm-2">
				<!-- <input id="btn_save_user" value="Lưu Lại" type="submit" name="btn_save_user" style="width: 70px;height: 35px;background: #10b1dd;color: #fff;border-radius: 8px;padding: 3px 8px;font-size: 15px;border: solid 1px #D7D7D7;">
				</input> -->
			</div>
		</div>
		<div class="col-sm-12" id="rowHS" style="margin-top: 30px">
			<div class="col-sm-2 lable">
				<label>Tài khoản:</label>
			</div>
			<div class="col-sm-8">
				<input class="input-form" type="text" id="username" name="username" value="<?php echo $model['username']; ?>">
			</div>
		</div>
		<div class="col-sm-12 password" id="rowHS">
			<div class="col-sm-2 lable">
				<label>Mật Khẩu:</label>
			</div>
			<div class="col-sm-8">
				<input class="input-form" disabled type="password" id="password" name="password" value='<?php echo $model['username']; ?>'>
				<span onclick="change_pass()" style="color: #6ec4a1;margin-top: 10px;cursor: pointer;">Đổi mật khẩu</span>
			</div>
		</div>
		<div id="update_password" style="display: none;">
			<div class="col-sm-12" id="rowHS">
				<div class="col-sm-2 lable">
					<label>Mật khẩu cũ:</label>
				</div>
				<div class="col-sm-8">
					<input class="input-form" type="password" id="pass_old" name="pass_old" value="">
					<span id="check_pass_old" style="display: none;">
						<i class="fa fa-check" style="color: green;font-size: 20px;" aria-hidden="true"></i>
					</span>
					<span onclick="cancel_update_pass()" style="color: #10b1dd;margin-top: 10px;cursor: pointer;">Hủy</span>
				</div>
			</div>
			<div class="col-sm-12" id="rowHS">
				<div class="col-sm-2 lable">
					<label>Mật khẩu mới:</label>
				</div>
				<div class="col-sm-8">
					<input class="input-form" type="password" id="pass_new" name="pass_new" value="">
				</div>
			</div>
			<div class="col-sm-12" id="rowHS">
				<div class="col-sm-2 lable">
					<label>Xác nhận mật khẩu:</label>
				</div>
				<div class="col-sm-8">
					<input class="input-form" type="password" id="confirm_pass" name="confirm_pass" value="">
					<span id="check_confirm_pass" style="display: none;">
						<i class="fa fa-check" style="color: green;font-size: 20px;" aria-hidden="true"></i>
					</span>
				</div>
			</div>
		</div>
		<div class="col-sm-12" id="rowHS">
			<div class="col-sm-2 lable">
				<label>Email:</label>
			</div>
			<div class="col-sm-8">
				<input class="input-form" type="text" id="email" name="email" value='<?php echo $model->email ?>'>
			</div>
		</div>
		<div class="col-sm-12" id="rowHS">
			<div class="col-sm-2 lable">
				<label>Cơ Sở:</label>
			</div>
			<div class="col-sm-3">
				<select class="input-form" id="branch_user" name="branch_user">
					<?php for($i=1 ; $i<=2 ; $i++){
						if($model['id_branch'] == $i){
							?>
						<option selected value="<?php echo $i ?>">Cơ sở <?php echo $i ?></option>
						<?php 
						}else { ?>
						<option value="<?php echo $i ?>">Cơ sở <?php echo $i ?></option>
						<?php }
						} ?>
						
				</select>
			</div>
		</div>
		<div class="col-sm-12" id="rowHS">
			<div class="col-sm-2 lable">
				<label>Nhóm:</label>
			</div>
			<div class="col-sm-3">
				<select class="input-form" id="group_user" name="group_user">
				<?php foreach ($group_user as $value) {
					if($model['group_id'] == $value['id']){
				?>
					<option selected="selected" value="<?php echo $value['id'] ?>"><?php echo $value['group_name']; ?></option>
				<?php }else { ?>
					<option value="<?php echo $value['id'] ?>"><?php echo $value['group_name']; ?></option>
				<?php } } ?>
				</select>
			</div>
		</div>
		<div class="col-sm-12" id="rowHS">
			<div class="col-sm-2 lable">
				<label>Trạng thái:</label>
			</div>
			<div class="col-sm-3">
			<?php $array_block = array('Not Block','Block','Delete'); ?>
				<select class="input-form" id="block_user" name="block_user">
					<?php for ($i=0; $i <= 2; $i++) {
						if($model['block'] == $i){
					?>
					<option selected="selected" value="<?php echo $i; ?>"><?php echo $array_block[$i]; ?></option>
					<?php } else { ?>
						<option value="<?php echo $i; ?>"><?php echo $array_block[$i]; ?></option>
					<?php	} } ?>
				</select>
			</div>
		</div>
		<div class="col-sm-12" id="rowHS">
			<hr>
			<div class="col-sm-2">
				<label>Dịch vụ:</label>
			</div>
			
			<div class="col-sm-8">
				<div class="example">
                    <select name="list_service[]" id="example-enableClickableOptGroups-disabled" multiple="multiple">
                         <?php foreach ($model->getService() as $k=>$v)
                         {
                         	$service_user = CsServiceUsers::model()->findAllByAttributes(array('id_service'=>$v['id'],'id_user'=>$id_dentist));
                         	if($service_user)
                         	{ ?>
                         		<option selected="selected" value="<?php echo $v['id'] ?>"><?php echo $v['name'] ?></option>
                         <?php	}
                         	else { ?>
                         		<option value="<?php echo $v['id'] ?>"><?php echo $v['name'] ?></option>
                         <?php	}
                          } ?>
                      </select>
                 </div>
                
			</div>
		</div>
		<div class="col-sm-12" id="rowHS">
			<div class="col-sm-2 lable">
				<label>Kinh Nghiệm:</label>
			</div>
			<div class="col-sm-8">
				<textarea style="height: 75px; width: 80%; overflow: hidden; word-wrap: break-word; resize: none;" id="staff_exp" name="staff_exp" class="span7 yellow_hover blue_focus input-form" placeholder="Staff Description"><?php echo $model['exp']; ?></textarea>
			</div>
		</div>
		<div class="col-sm-12" id="rowHS">
			<div class="col-sm-2 lable">
				<label>Bằng Cấp:</label>
			</div>
			<div class="col-sm-8">
				<textarea style="height: 75px; width: 80%; overflow: hidden; word-wrap: break-word; resize: none;" id="staff_diploma" name="staff_diploma" class="span7 yellow_hover blue_focus input-form" placeholder="Staff Description"><?php echo $model['diploma']; ?></textarea>
			</div>
		</div>
		<div class="col-sm-12" id="rowHS">
			<div class="col-sm-2 lable">
				<label>Chứng Chỉ:</label>
			</div>
			<div class="col-sm-8">
				<textarea style="height: 75px; width: 80%; overflow: hidden; word-wrap: break-word; resize: none;" id="staff_certificate" name="staff_certificate" class="span7 yellow_hover blue_focus input-form" placeholder="Staff Description"><?php echo $model['certificate']; ?></textarea>
			</div>
		</div>
	</form>
</div>
<script type="text/javascript">
	$(document).ready(function(){
		$('#pass_old').change(function(){
			var pass_old = $('#pass_old').val();
			var id_dentist = $('#id_dentist').val();
			jQuery.ajax({
	            type: "POST",
	            url: "<?php echo CController::createUrl('Staff/TestPassOld')?>",
	            data: {
	            	'id_dentist' : id_dentist,
	            	'pass_old' : pass_old,
	            },
	            success:function(data)
	            {
	            	// alert(data);
	            	if(data == 0)
	            	{
	                	alert("Mật khẩu không đúng! Vui lòng nhập lại");
	                	document.forms['form_data_user'].pass_old.focus();
	                	$('#pass_old').val("");
	            	}
	            	else {
	            		$('#check_pass_old').css({'display':'inline-block'});
	            	}
	            },
	            error: function (data) {
	                alert("Error occured.Please try again!");

	            },
        	});

		});
		$('#pass_new').change(function(){
			var pass_old = $('#pass_old').val();
			if(pass_old =="")
			{
				alert("Vui lòng nhập mật khẩu cũ !");
				document.forms['form_data_user'].pass_old.focus();
				$('#pass_new').val("");
			}
		});
		$('#confirm_pass').change(function(){
			var pass_new = $('#pass_new').val();
			var confirm_pass = $('#confirm_pass').val();
			var pass_old = $('#pass_old').val();
			if(pass_old =="")
			{
				alert("Vui lòng nhập mật khẩu cũ !");
				document.forms['form_data_user'].pass_old.focus();
				$('#confirm_pass').val("");
			}
			else if(pass_new =="")
			{
				alert("Vui lòng nhập mật khẩu mới !");
				document.forms['form_data_user'].pass_new.focus();
				$('#confirm_pass').val("");
			}
			else if(pass_new != confirm_pass)
			{
				alert("Xác nhận lại mật khẩu không khớp ! Vui lòng kiểm tra lại.");
				document.forms['form_data_user'].confirm_pass.focus();
				$('#confirm_pass').val("");
			}
			else
			{
				saveinfo();
				$('#check_confirm_pass').css({'display':'inline-block'});
			}
		});
		$('#email').change(function(){
			var reg_mail = /^[A-Za-z0-9]+([_\.\-]?[A-Za-z0-9])*@[A-Za-z0-9]+([\.\-]?[A-Za-z0-9]+)*(\.[A-Za-z]+)+$/;
			var email = $('#email').val();
			if(email=="")
			{
				alert("Vui lòng nhập email!");
				document.forms['form_data_user'].email.focus();
				return false;
			}
			else if(reg_mail.test(email)==false)
			{
				alert("Email này không hợp lệ! vui lòng nhập lại");
				document.forms['form_data_user'].email.focus();
				$('#email').val("");
				return false;
			}
			else
			{
				saveinfo();
			}
		});
		function saveinfo(){
			var formData = new FormData($("#form_data_user")[0]);
			 jQuery.ajax({
	            type: "POST",
	            url: "<?php echo CController::createUrl('Staff/UpdateServiceUsers')?>",
	            data: formData,
		        cache: false,
		        processData: false,
		        contentType: false,
	            success:function(data)
	            {         
	            	if(data)
	            	{
	            		$('#alert-success').append(data);
	            		var element = $('.alert-success');
	            		// var count = element.length;
	            		for (var i = element.length; i >= 0; i--) {
	            			$(element[i]).fadeTo(2000, 500).slideUp(500, function(){
								$(this).remove();
							});
	            		}
	            	}
	            },
	            error: function (data) {
	                alert("Error occured.Please try again!");

	            },
        	});
		}
		$('#staff_exp,#staff_diploma,#staff_certificate,#example-enableClickableOptGroups-disabled,#block_user,#group_user,#branch_user,#name_user,#username,#staffimageinput').change(function(){
			saveinfo();
		});
		$('#form_data_user').submit(function(e){
			e.preventDefault();
			// alert("asdasdadacccc");
			// return false;
			 var formData = new FormData($("#form_data_user")[0]);
			 jQuery.ajax({
	            type: "POST",
	            url: "<?php echo CController::createUrl('Staff/UpdateServiceUsers')?>",
	            data: formData,
		        cache: false,
		        processData: false,
		        contentType: false,
	            success:function(data)
	            {
	                // if (data) {
	                	alert(data);
	                // }
	            },
	            error: function (data) {
	                alert("Error occured.Please try again!");

	            },
        	});
			// return false;
		});
	});
	function change_pass()
	{
		$('.password').css({'display':'none'});
		$('#update_password').css({'display':'block'});
	}
	function cancel_update_pass()
	{
		$('.password').css({'display':'block'});
		$('#update_password').css({'display':'none'});
		$('#pass_old').val('');
		$('#pass_new').val('');
		$('#confirm_pass').val('');
		$('#check_pass_old').css({'display':'none'});
		$('#check_confirm_pass').css({'display':'none'});

	}
</script>
<script type="text/javascript">
  $('#staffimageinput').on('change', function(evt) {
    var tgt = evt.target || window.event.srcElement,
        files = tgt.files;

    // FileReader support
    if (FileReader && files && files.length) {
        var fr = new FileReader();
        fr.onload = function () {
            document.getElementById('hinh_user').src = fr.result;
        }
        fr.readAsDataURL(files[0]);
    }
});
</script>
